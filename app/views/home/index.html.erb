<div class="container mt-5">
  <div class="row">
    <div class="col-12">
      <h2>Item List</h2>
    </div>
  </div>
  <div id="example">
    <div class="demo-section k-content wide">
      <div class="row">
        <div id="listView" class="col-7"></div>
        <div class="col-3">
          <h4>Cart</h4>
          <div class="row">
            <div class="col-12">
              <label>Total:</label>
              <p id="cart-total">
              </p>
            </div>
          </div>
        </div>
      </div>
    </div>

    <script type="text/x-kendo-template" id="template">
      <div class="row">
        <div class="col-12">
          <div class="item">
            <div class="row">
              <div class="col-4">
                <h3>#:Name#</h3>
                <h3>#:Id#</h3>
                <h3>#:Category#</h3>
                <h3>Stock: #:Stock#</h3>
                <p>#:kendo.toString(Price, "c")#</p>
                <p>#:Availability#</p>
              </div>
              <div class="col-5">
                <button class="k-button increaseItem">+</button>
                <input value="0" type="number" title="numeric" min="0" max="#:Stock#" />
                <button class="k-button decreaseItem">-</button>
              </div>
            </div>
          </div>
        </div>        
      </div>
    </script>

    <script>
        $(function() {
            var dataSourceItems = new kendo.data.DataSource({
                data: [
                        { 
                          "Id":"878637-010",
                          "Name":"ZOOM KD 9 ELITE HYPER ORANGE",
                          "Category": "Basketball",
                          "Stock":15,
                          "Price":2899.00,
                          "Availability": true
                        },
                        { 
                          "Id":"852405-004",
                          "Name":"LEBRON XIV",
                          "Category": "Basketball",
                          "Stock":10,
                          "Price":3699.00,
                          "Availability": true
                        },
                        { 
                          "Id":"881465-120",
                          "Name":"JORDAN FORMULA 23",
                          "Category": "Basketball",
                          "Stock":5,
                          "Price":2399.00,
                          "Availability": true
                        },
                        { 
                          "Id":"852422-601",
                          "Name":"ZOOM REV 2017",
                          "Category": "Basketball",
                          "Stock":0,
                          "Price":1999.00,
                          "Availability": false
                        },
                        { 
                          "Id":"852473-600",
                          "Name":"MAMBA INSTINCT",
                          "Category": "Basketball",
                          "Stock":0,
                          "Price":1799.00,
                          "Availability": false
                        },
                        { 
                          "Id":"917391-010",
                          "Name":"PLAYERA DRY KD",
                          "Category": "Shirts",
                          "Stock":20,
                          "Price":549,
                          "Availability":true
                        },
                        { 
                          "Id":"843130-477",
                          "Name":"PLAYERA AIR JORDAN 23",
                          "Category": "Shirts",
                          "Stock":40,
                          "Price":549.00,
                          "Availability":true
                        },
                        { 
                          "Id":"831348-100",
                          "Name":"SHORT ULTIMATE FLIGHT",
                          "Category": "Shorts",
                          "Stock":10,
                          "Price":899.00,
                          "Availability": true
                        },
                        { 
                          "Id":"836277-457",
                          "Name":"SHORT FT GX FRANCHISE",
                          "Category": "Shorts",
                          "Stock":10,
                          "Price":849,
                          "Availability":true
                        },
                        { 
                          "Id":"1281295-002",
                          "Name":"SHORT SC30 TOP GUN",
                          "Category": "Shorts",
                          "Stock":5,
                          "Price":799,
                          "Availability": true
                        },
                      ]
            });
            var dataSourceCart = new kendo.data.DataSource({aggregate: [{ field: "Price", aggregate: "sum" }] });
            $("#listView").kendoListView({
                dataSource: dataSourceItems,
                template: kendo.template($("#template").html())
            });
            $(".numeric").kendoNumericTextBox({
              decimals: 0
            });
            $(".increaseItem").click(function(){
              var id = $(this).parent().parent().children()[0].children[1].textContent
              var name = $(this).parent().parent().children()[0].children[0].textContent
              var price = $(this).parent().parent().children()[0].children[4].textContent
              dataSourceCart.add({ Name: name, Price: price })
              dataSourceCart.sync
              //$("#cart-total").html(dataSourceCart._data[0].Price);

              $(this).next('input').val( function(i, oldval) {
                return ++oldval;
              });

              dataSourceCart.fetch(function(){
                var results = dataSourceCart.aggregates().Price;
                $("#cart-total").html(results.sum);
              });
            });
            
            $(".decreaseItem").click(function(){
              var id = $(this).parent().parent().children()[0].children[1].textContent
              var name = $(this).parent().parent().children()[0].children[0].textContent
              var price = $(this).parent().parent().children()[0].children[4].textContent
              dataItem = dataSourceCart.get(id);
              dataSourceCart.remove(dataItem);
              dataSourceCart.fetch(function(){
                var results = dataSourceCart.aggregates().price;
                $("#cart-total").html(results.sum);
              });
              $(this).prev('input').attr('id')
            });
            
        });
    </script>
  </div>
</div>


<script>
  var viewModel = kendo.observable();
</script>